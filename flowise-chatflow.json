{
  "name": "Modern Chat Widget - إيجي أفريكا",
  "description": "نظام دردشة هجين يجمع بين Simple Intent Detection والذكاء الاصطناعي",
  "nodes": [
    {
      "id": "1",
      "name": "Chat Widget",
      "type": "chatWidget",
      "position": {
        "x": 100,
        "y": 100
      },
      "data": {
        "widgetConfig": {
          "name": "إيجي أفريكا",
          "description": "مساعد ذكي للتسويق الإلكتروني والذكاء الاصطناعي",
          "theme": "light",
          "primaryColor": "#3B82F6",
          "secondaryColor": "#8B5CF6",
          "placeholder": "اكتب رسالتك هنا...",
          "welcomeMessage": "أهلاً بيك! 👋 أنا مساعد إيجي أفريكا الذكي. أقدر أساعدك في التسويق الإلكتروني والذكاء الاصطناعي. تحب نبدأ بإيه؟",
          "position": "bottom-right",
          "size": "medium",
          "showBranding": false,
          "showTypingIndicator": true,
          "showReadMore": true,
          "showScrollToBottom": true,
          "showFileUpload": false,
          "showVoiceInput": false,
          "showEmojiPicker": true,
          "showQuickReplies": true,
          "quickReplies": [
            "أهلاً",
            "الخدمات",
            "الأسعار",
            "احجز الآن",
            "اتصل بنا"
          ]
        }
      }
    },
    {
      "id": "2",
      "name": "Simple Intent Detection",
      "type": "function",
      "position": {
        "x": 400,
        "y": 100
      },
      "data": {
        "function": `
// Simple Intent Detection for Arabic
const detectIntent = (message) => {
  const normalizedMessage = message.toLowerCase().trim();
  
  // Greeting patterns
  if (['أهلاً', 'أهلا', 'مرحبا', 'السلام عليكم', 'سلام عليكم'].some(pattern => 
    normalizedMessage.includes(pattern))) {
    return {
      intent: 'greet',
      confidence: 0.95,
      response: 'أهلاً وسهلاً! 👋 كيف أقدر أساعدك اليوم؟',
      shouldUseLangChain: false
    };
  }
  
  // Service inquiry patterns
  if (['الخدمات', 'الخدمة', 'خدمات', 'إيه الخدمات', 'ما هي الخدمات'].some(pattern => 
    normalizedMessage.includes(pattern))) {
    return {
      intent: 'service_inquiry',
      confidence: 0.9,
      response: 'خدماتنا متعددة! 🛠️ تسويق إلكتروني، ذكاء اصطناعي، تطوير مواقع، تصميم جرافيك. إيه اللي يعجبك؟',
      shouldUseLangChain: false
    };
  }
  
  // Pricing inquiry patterns
  if (['الأسعار', 'السعر', 'بكم', 'بكام', 'التكلفة'].some(pattern => 
    normalizedMessage.includes(pattern))) {
    return {
      intent: 'pricing_inquiry',
      confidence: 0.9,
      response: 'أسعارنا تنافسية جداً! 💰 تحب تشوف الخطة المناسبة ليك؟ يمكنني مساعدتك في اختيار أفضل خطة.',
      shouldUseLangChain: false
    };
  }
  
  // Booking patterns
  if (['احجز', 'حجز', 'موعد', 'استشارة', 'جلسة'].some(pattern => 
    normalizedMessage.includes(pattern))) {
    return {
      intent: 'booking_request',
      confidence: 0.95,
      response: 'ممتاز! 🎯 أقدر أساعدك في الحجز. متى تحب الموعد؟ وأي خدمة تريد؟',
      shouldUseLangChain: false
    };
  }
  
  // Thanks patterns
  if (['شكرا', 'شكراً', 'مشكور', 'متشكر'].some(pattern => 
    normalizedMessage.includes(pattern))) {
    return {
      intent: 'thanks',
      confidence: 0.9,
      response: 'العفو! 😊 سعيد إنني قدرت أساعدك. هل عندك أسئلة تانية؟',
      shouldUseLangChain: false
    };
  }
  
  // Complex questions - use LangChain
  if (normalizedMessage.length > 50 || normalizedMessage.includes('كيف') || normalizedMessage.includes('ما هي')) {
    return {
      intent: 'complex_question',
      confidence: 0.7,
      response: 'هذا سؤال ممتاز! 🧠 دعني أبحث لك عن إجابة مفصلة...',
      shouldUseLangChain: true
    };
  }
  
  // Default fallback
  return {
    intent: 'unknown',
    confidence: 0.5,
    response: 'أفهم إن سؤالك مهم! 🤔 هل يمكنك إعادة صياغته بطريقة أوضح؟',
    shouldUseLangChain: true
  };
};

// Process the message
const result = detectIntent($input);
return {
  intent: result.intent,
  confidence: result.confidence,
  response: result.response,
  shouldUseLangChain: result.shouldUseLangChain,
  message: $input
};
        `
      }
    },
    {
      "id": "3",
      "name": "LangChain Response",
      "type": "llmChain",
      "position": {
        "x": 700,
        "y": 100
      },
      "data": {
        "model": "gpt-3.5-turbo",
        "temperature": 0.7,
        "maxTokens": 500,
        "systemPrompt": `أنت مساعد إيجي أفريكا الذكي، متخصص في التسويق الإلكتروني والذكاء الاصطناعي.

مهمتك:
1. الإجابة على الأسئلة المتعلقة بالتسويق الإلكتروني
2. تقديم نصائح عملية ومفيدة
3. شرح المفاهيم التقنية بطريقة بسيطة
4. مساعدة العملاء في اختيار الخدمات المناسبة

أسلوبك:
- ودود ومهني
- دعم كامل للعربية
- إجابات مفصلة ومفيدة
- استخدام الإيموجي المناسبة

تذكر: أنت متخصص في مجال إيجي أفريكا، قدم إجابات دقيقة ومفيدة.`
      }
    },
    {
      "id": "4",
      "name": "Response Router",
      "type": "switch",
      "position": {
        "x": 550,
        "y": 250
      },
      "data": {
        "condition": "shouldUseLangChain === true"
      }
    },
    {
      "id": "5",
      "name": "Simple Response",
      "type": "textOutput",
      "position": {
        "x": 400,
        "y": 400
      },
      "data": {
        "text": "{{response}}"
      }
    },
    {
      "id": "6",
      "name": "Complex Response",
      "type": "textOutput",
      "position": {
        "x": 700,
        "y": 400
      },
      "data": {
        "text": "{{llmResponse}}"
      }
    }
  ],
  "edges": [
    {
      "source": "1",
      "target": "2"
    },
    {
      "source": "2",
      "target": "4"
    },
    {
      "source": "4",
      "target": "5",
      "condition": "false"
    },
    {
      "source": "4",
      "target": "3",
      "condition": "true"
    },
    {
      "source": "3",
      "target": "6"
    }
  ]
}
